/*!
 * Tatami-rails-adaptor v0.1.0
 * 
 *
 * Copyright 2013, 2014 Ourairyu, http://ourai.ws/
 *
 * Date: 2014-08-04
 */

(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;return Tatami.isPlainObject(null!=(q=Tatami.adaptor)?q.rails:void 0)?!1:(p=Tatami,g=new p.__class__.Storage("pageHandlers"),m={},d={},b=void 0,o=(null!=(r=this.Turbolinks)?r.supported:void 0)===!0,p.mixin({adaptor:{rails:{turbolinks:{enabled:o,handlers:g.storage,sequence:m,execution:d}}}}),o&&!function(){var a,b,d,e;return b=Node.prototype.insertBefore,a=0,e=0,d=function(){return a++,this.setAttribute("data-loaded",!0),console.log(this.src),a===e?k.apply(p,[c(!0),"ready"]):void 0},Node.prototype.insertBefore=function(a){return"script"===a.tagName.toLowerCase()&&p.data(a).inside&&(e++,a.async=!1,a.onload=d),b.apply(this,arguments)}}(),n=function(a){return a.replace("-","_")},f=function(a){return a.toString().length.toString(16)+""},e=function(a,b,c,d){return this.equal(c,g.get(""+b+"."+a+"."+d))},h=function(a,b,c){var d;return d=this.namespace(m,""+a+"."+b),null==d&&(d=m[a][b]=[]),d.push(c)},a=function(a,b,c,d){var i;return i={},this.each(b,function(b){return function(g,j){var k;return d&&(c=g,g=j),null==g&&(g="unspecified"),g=n(g),k=f(c),e.apply(b,[a,g,c,k])||(b.namespace(i,""+g+"."+a+"."+k),i[g][a][k]=c,h.apply(b,[g,a,k])),!0}}(this)),g.set(i)},k=function(a,b,c){var d,e;return d=null!=(e=g.storage[a])?e[b]:void 0,d?this.each(m[a][b],function(a){return c&&c(),d[a]()}):void 0},j=function(a){var b,d,e;return d=["unspecified"],b=c(!0),e=$("body script[data-inside]:not([data-turbolinks-eval='false'][data-loaded='true'])"),"prepare"!==a&&o&&0!==e.size()||d.push(b),this.each(d,function(b){return function(c){return k.apply(b,[c,a])}}(this))},l=function(a,b,c){return this.each(a,function(a,d){return c&&(b=a,a=d),$("body").is("[data-page='"+a+"']")?(b(),!1):void 0})},c=function(a){var b;return b=$("body").data("page"),a===!0?n(b):b},p.extend({handlers:[{name:"inPage",handler:function(b,d,e){var f,g,h;return g=this.isPlainObject(b),1!==arguments.length||g?(this.isString(b)&&(b=[b]),f=[b,d,g],e===!0||null==document.body?(f.unshift("init"),a.apply(this,f)):l.apply(this,f)):(this.isArray(b)||(b=[b]),h=this.inArray(c(),b)>-1),h||!1},validator:function(a){return this.isString(a)||this.isArray(a)||this.isPlainObject(a)},value:!1}]}),void(p.hasProp("supported",this.Turbolinks)&&(p.mixin({prepare:function(c){a.call(this,"prepare",[b],c)},ready:function(c,d){a.call(this,"ready",[null!=d?n(d):b],c)}}),i=function(){var a;return console.log("Run! Run!! Run!!!"),a=c(!0),k.call(this,a,"init",function(){return b=a}),j.call(this,"prepare"),j.call(this,"ready")},p.init({runSandbox:function(){return $(document).ready(function(a){return function(){return i.call(a)}}(this))}}))))}).call(this);
//# sourceMappingURL=tatami-rails-adaptor.min.map