/*!
 * Tatami-rails-adaptor v0.1.0
 * 
 *
 * Copyright 2013, 2014 Ourairyu, http://ourai.ws/
 *
 * Date: 2014-07-29
 */

(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;o=this.Turbolinks&&this.Turbolinks.supported===!0,a=Tatami.__class__.Storage,g=new a("pageHandlers"),h=new a("prepareHandlers"),i=new a("readyHandlers"),c=void 0,n=function(a){return a.replace("-","_")},f=function(a){return a.toString().length.toString(16)+""},e=function(a,b,c){var d,e,g;return g=f(c),e=a.get(""+b+"."+g),d=this.equal(c,e)},b=function(a,b,c,d){var g;return g={},this.each(b,function(b){return function(h,i){var j;return d&&(c=h,h=i),null==h&&(h="__GLOBAL__"),h=n(h),e.apply(b,[a,h,c])?void 0:(j=f(c),b.namespace(g,""+h+"."+j),g[h][j]=c)}}(this)),a.set(g)},j=function(a,b){return this.each(a,function(a){return b&&b(),a()})},l=function(){return j.call(this,h.storage.__GLOBAL__),j.call(this,h.storage[d(!0)])},m=function(){return j.call(this,i.storage.__GLOBAL__),j.call(this,i.storage[d(!0)])},k=function(a,b,c){return this.each(a,function(a,d){return c&&(b=a,a=d),$("body").is("[data-page='"+a+"']")?(b(),!1):void 0})},d=function(a){var b;return b=$("body").data("page"),a===!0?n(b):b},Tatami.extend({handlers:[{name:"inPage",handler:function(a,c){var e,f,h;return f=this.isPlainObject(a),1!==arguments.length||f?(this.isString(a)&&(a=[a]),e=[a,c,f],o?(e.unshift(g),b.apply(this,e)):k.apply(this,e)):(this.isArray(a)||(a=[a]),h=this.inArray(d(),a)>-1),h||!1},validator:function(a){return this.isString(a)||this.isArray(a)||this.isPlainObject(a)},value:!1}]}),o&&(Tatami.mixin({prepare:function(a){b.call(this,h,[c],a)},ready:function(a){b.call(this,i,[c],a)}}),Tatami.init({runSandbox:function(){return $(document).on({"page:change":function(a){return function(){var b;return console.log("change"),b=d(!0),j.call(a,g.storage[b],function(){return c=b}),l.call(a)}}(this),"page:load":function(a){return function(){return console.log("load"),m.call(a)}}(this)})}}))}).call(this);
//# sourceMappingURL=tatami-rails-adaptor.min.map