/*!
 * Tatami-rails-adaptor v0.1.0
 * 
 *
 * Copyright 2013, 2014 Ourairyu, http://ourai.ws/
 *
 * Date: 2014-07-31
 */

(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;return Tatami.isPlainObject(null!=(o=Tatami.adaptor)?o.rails:void 0)?(n=Tatami,f=new n.__class__.Storage("pageHandlers"),l={},b=void 0,n.mixin({adaptor:{rails:{turbolinks:{enabled:(null!=(p=this.Turbolinks)?p.supported:void 0)===!0,handlers:f.storage,sequence:l}}}}),m=function(a){return a.replace("-","_")},e=function(a){return a.toString().length.toString(16)+""},d=function(a,b,c,d){return this.equal(c,f.get(""+b+"."+a+"."+d))},g=function(a,b,c){var d;return d=this.namespace(l,""+a+"."+b),null==d&&(d=l[a][b]=[]),d.push(c)},a=function(a,b,c,h){var i;return i={},this.each(b,function(b){return function(f,j){var k;return h&&(c=f,f=j),null==f&&(f="unspecified"),f=m(f),k=e(c),d.apply(b,[a,f,c,k])?void 0:(b.namespace(i,""+f+"."+a+"."+k),i[f][a][k]=c,g.apply(b,[f,a,k]))}}(this)),f.set(i)},j=function(a,b,c){var d,e;return d=null!=(e=f.storage[a])?e[b]:void 0,d?this.each(l[a][b],function(a){return c&&c(),d[a]()}):void 0},i=function(a){var b,d,e,f,g,h;return f=["unspecified"],b=c(!0),h="body script[data-inside]",("prepare"===a||0===$(""+h+":not([data-turbolinks-eval='false'][data-loaded='true'])").size())&&f.push(b),this.each(f,function(b){return function(c){return j.apply(b,[c,a])}}(this)),(g=$(""+h+":not([data-turbolinks-eval='false'])")).size()>0?(d=this,e=0,$(g).on("load",function(){return e++,$(this).attr("data-loaded",!0),e===g.size()?j.apply(d,[b,a]):void 0})):void 0},k=function(a,b,c){return this.each(a,function(a,d){return c&&(b=a,a=d),$("body").is("[data-page='"+a+"']")?(b(),!1):void 0})},c=function(a){var b;return b=$("body").data("page"),a===!0?m(b):b},n.extend({handlers:[{name:"inPage",handler:function(b,d,e){var f,g,h;return g=this.isPlainObject(b),1!==arguments.length||g?(this.isString(b)&&(b=[b]),f=[b,d,g],e===!0||null==document.body?(f.unshift("init"),a.apply(this,f)):k.apply(this,f)):(this.isArray(b)||(b=[b]),h=this.inArray(c(),b)>-1),h||!1},validator:function(a){return this.isString(a)||this.isArray(a)||this.isPlainObject(a)},value:!1}]}),void(n.hasProp("supported",this.Turbolinks)&&(n.mixin({prepare:function(c){a.call(this,"prepare",[b],c)},ready:function(c,d){a.call(this,"ready",[null!=d?m(d):b],c)}}),h=function(a){var d;return d=c(!0),j.call(a,d,"init",function(){return b=d}),i.call(a,"prepare"),i.call(a,"ready")},n.init({runSandbox:function(){var a;return a=this,this.adaptor.rails.turbolinks.enabled?$(document).on({"page:change":function(){return h(a)}}):$(document).ready(function(){return h(a)})}})))):!1}).call(this);
//# sourceMappingURL=tatami-rails-adaptor.min.map