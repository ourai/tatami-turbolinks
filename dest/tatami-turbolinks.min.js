/*!
 * Tatami-turbolinks v0.1.8
 * 
 *
 * Copyright 2013, 2015 Ourairyu, http://ourai.ws/
 *
 * Date: 2015-07-27
 */

(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return Tatami.isPlainObject(Tatami.rails)?!1:(x=Tatami,k=new x.__class__.Storage("pageHandlers"),r={},b={},c=void 0,w=(null!=(z=this.Turbolinks)?z.supported:void 0)===!0,l=!1,x.mixin({rails:{turbolinks:{enabled:w,handlers:k.storage,sequence:r,counter:b}}}),w&&!function(){var a,b,c,e;return b=Node.prototype.insertBefore,a=0,e=0,c=function(){return a++,this.setAttribute("data-loaded",!0),a===e?p(d(!0),"ready"):void 0},Node.prototype.insertBefore=function(a){return 1===a.nodeType&&"script"===a.tagName.toLowerCase()&&x.data(a).inside&&(e++,a.async=!1,a.onload=c),b.apply(this,arguments)}}(),v=function(a){return a.replace("-","_")},i=function(a,b,c,d){var e,f;return f=k.get(""+b+"."+a+"."+d),e=!1,null!=f&&x.each(f,function(a){return e=x.hasProp("id",a)||x.hasProp("id",c)?c.id===a.id:x.equal(c,a),!e}),e},j=function(a,c,d){var e,f,g;return e=(null!=d.id?""+d.id+"_":"")+d.toString().length.toString(16),x.namespace(b,e),i(a,c,d,e)||(b[e]=(null!=(g=b[e])?g:0)+1,f=""+e+"."+b[e]),f},m=function(a,b,c){var d;return d=x.namespace(r,""+a+"."+b),null==d&&(d=r[a][b]=[]),d.push(c)},e=function(a,b,c){var d,e,f;e=k.storage[a][b],f=c.split(".");try{delete e[f[0]][f[1]]}catch(g){d=g,e[f[0]][f[1]]=void 0}r[a][b]=x.filter(r[a][b],function(a){return a!==c})},h=function(a,b){var d,e;return e=b[1],d=x.isBoolean(e)?e:b[2],e=null!=e&&x.isString(e)?v(e):c,[a,[e],b[0],d]},a=function(a,b,c,d){var e,f;return f=x.isPlainObject(b),e={},x.each(b,function(b,g){var h,i;return f&&(c=b,b=g),d&&(c.execOnce=!0),null==b&&(b="unspecified"),b=v(b),h=j(a,b,c),null!=h&&(x.namespace(e,""+b+"."+a+"."+h),i=h.split("."),e[b][a][i[0]][i[1]]=c,m(b,a,h)),!0}),k.set(e)},p=function(a,b,c){var d,f;return d=null!=(f=k.storage[a])?f[b]:void 0,d?x.each(r[a][b],function(f){var g,h;return h=f.split("."),g=d[h[0]][h[1]],c&&c(),g(),g.execOnce?e(a,b,f):void 0}):void 0},o=function(a){var b,c,e;return c=["unspecified"],b=d(!0),e=$("body script[data-inside]:not([data-turbolinks-eval='false'][data-loaded='true'])"),"prepare"!==a&&w&&l&&0!==e.size()||c.push(b),x.each(c,function(b){return p(b,a)})},q=function(a,b,c){return x.each(a,function(a,d){return c&&(b=a,a=d),$("body").is("[data-page='"+a+"']")?(b(),!1):void 0})},d=function(a){var b;return b=$("body").data("page"),a===!0?v(b):b},x.extend({handlers:[{name:"inPage",handler:function(b,c,e){var f,g,h;return g=this.isPlainObject(b),1!==arguments.length||g?(this.isString(b)&&(b=[b]),f=[b,c],e===!0||null==document.body?(f.unshift("init"),a.apply(this,f)):(f.push(g),q.apply(this,f))):(this.isArray(b)||(b=[b]),h=this.inArray(d(),b)>-1),h||!1},validator:function(a){return this.isString(a)||this.isArray(a)||this.isPlainObject(a)},value:!1},{name:"runInWidget",handler:function(){var a,b,c,d;return a=this.slice(arguments),c=a[0],this.isFunction(c)&&(b=c,a=this.slice(a,1),c=a[0]),this.functionExists(c)?this.run.apply(this,a):(d=function(c){return function(){return b&&b(),c.run.apply(c,a)}}(this),d.id=c,this.ready(d,$("body").data("page"),!0))}}]}),void(x.hasProp("supported",this.Turbolinks)&&(y=x.data,g=function(){var a;return null!=(a=$("body").data(""+x.__meta__.name+".cache"))?a:{}},t=function(a){return $("body").data(""+x.__meta__.name+".cache",a),a},f=function(a){var b,c;return b=a.split("."),c=g(),x.each(b,function(a){var b;return b=x.hasProp(a,c),c=c[a],b}),c},u=function(a,b){var c,d,e,f,h,i;return h=a.split("."),f=h.length,d=x.isPlainObject(b),c=g(),1===f?(e=h[0],i=s(c,e,b,x.hasProp(e,c))):(i=c,x.each(h,function(a,c){return f-1>c?x.hasProp(a,i)||(i[a]={}):i[a]=s(i,a,b,x.isPlainObject(i[a])),i=i[a],!0})),t(c),i},s=function(a,b,c,d){return d&&x.isPlainObject(c)?$.extend(!0,a[b],c):a[b]=c,a[b]},x.mixin({prepare:function(){a.apply(this,h("prepare",arguments))},ready:function(){a.apply(this,h("ready",arguments))},data:function(){var a,b,c,d;return a=arguments,b=a.length,d=a[0],c=b>0&&this.isString(d)&&/^[0-9A-Z_.]+[^_.]?$/i.test(d)?1===b?f(d):setCachedData(d,a[1]):y.apply(this,this.slice(a)),null!=c?c:null}}),n=function(){var a;return a=d(!0),p(a,"init",function(){return c=a}),o("prepare"),o("ready")},x.init({runSandbox:function(){return $(document).on({"page:fetch":function(){return l=!0,x.destroySystemDialogs()},"page:load":function(){return l=!1}}),$(document).ready(function(){return n()})}}))))}).call(this);
//# sourceMappingURL=tatami-turbolinks.min.map